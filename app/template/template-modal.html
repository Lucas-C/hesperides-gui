<md-dialog flex="auto">
    <md-dialog-content>
        <div class="ng-binding">
            <h2>Ajout/Edition de template</h2>

            <md-content layout-padding class="autoScroll">
                <form name="templateForm" novalidate>
                    <md-input-container md-no-float class="md-block">
                        <label>Titre</label>
                        <input type="text" required ng-trim="true" ng-model="template.name"
                               ng-disabled="isReadOnly"
                               ng-focus="true"
                               md-autofocus="true"
                               id="templateName" placeholder="Le titre du template est unique" />
                    </md-input-container>
                    <md-input-container md-no-float class="md-block">
                        <label>Nom du fichier final</label>
                        <input type="text" required ng-trim="true" ng-model="template.filename"
                               ng-disabled="isReadOnly"
                               id="templateFilename" placeholder="Indiquer le nom qu'aura le fichier sur le serveur. On peut utiliser des proprietes dans ce champ"/>
                    </md-input-container>
                    <md-input-container md-no-float class="md-block">
                        <label>Dossier de destination</label>
                        <input type="text" required ng-trim="true" ng-model="template.location"
                               ng-disabled="isReadOnly"
                               id="templateLocation" placeholder="Indiquer le dossier dans lequel sera copie le fichier sur le serveur. On peut utiliser des proprietes dans ce champ"/>
                    </md-input-container>
                    <div layout="row">
                        <div flex>
                            <label class="template-section-header">Contenu du fichier</label>
                            <kbd>F11</kbd> Activer /
                            <kbd>Esc</kbd> Desactiver l'edtion en plein ecran
                        </div>
                        <div flex="none">
                            <label class="template-section-header">Mode MIME:</label>
                            <select ng-init="selectedMode = codemirrorModes[0]" ng-options="mode.name for mode in codemirrorModes" ng-model="selectedMode" ng-change="changeCodeMirrorMode(selectedMode.mimetype)"></select>
                        </div>
                    </div>
                    <div id="templateContentParent">
                        <ui-codemirror id="templateContent" ui-codemirror-opts="codeMirrorOptions"
                                       ng-model="template.content" ng-keydown="$checkIfCodeMirrorInFullScreen($event)"></ui-codemirror>
                    </div>

                    <div class="template-right">
                        <fieldset class="standard">
                            <legend>User</legend>
                            R <select ng-model="template.rights.user.read">
                            <option value="" ng-selected="template.rights.user.read == null"></option>
                            <option value="true" ng-selected="template.rights.user.read === true">O</option>
                            <option value="false" ng-selected="template.rights.user.read === false">N</option>
                        </select>

                            W <select ng-model="template.rights.user.write">
                            <option value="" ng-selected="template.rights.user.write == null"></option>
                            <option value="true" ng-selected="template.rights.user.write === true">O</option>
                            <option value="false" ng-selected="template.rights.user.write === false">N</option>
                        </select>

                            X <select ng-model="template.rights.user.execute">
                            <option value="" ng-selected="template.rights.user.execute == null"></option>
                            <option value="true" ng-selected="template.rights.user.execute === true">O</option>
                            <option value="false" ng-selected="template.rights.user.execute === false">N</option>
                        </select>
                        </fieldset>

                        <fieldset class="standard">
                            <legend>Group</legend>
                            R <select ng-model="template.rights.group.read">
                            <option value="" ng-selected="template.rights.group.read == null"></option>
                            <option value="true" ng-selected="template.rights.group.read === true">O</option>
                            <option value="false" ng-selected="template.rights.group.read === false">N</option>
                        </select>

                            W <select ng-model="template.rights.group.write">
                            <option value="" ng-selected="template.rights.group.write == null"></option>
                            <option value="true" ng-selected="template.rights.group.write === true">O</option>
                            <option value="false" ng-selected="template.rights.group.write === false">N</option>
                        </select>

                            X <select ng-model="template.rights.group.execute">
                            <option value="" ng-selected="template.rights.group.execute == null"></option>
                            <option value="true" ng-selected="template.rights.group.execute === true">O</option>
                            <option value="false" ng-selected="template.rights.group.execute === false">N</option>
                        </select>
                        </fieldset>

                        <fieldset class="standard">
                            <legend>Other</legend>
                            R <select ng-model="template.rights.other.read">
                            <option value="" ng-selected="template.rights.other.read == null"></option>
                            <option value="true" ng-selected="template.rights.other.read === true">O</option>
                            <option value="false" ng-selected="template.rights.other.read === false">N</option>
                        </select>

                            W <select ng-model="template.rights.other.write">
                            <option value="" ng-selected="template.rights.other.write == null"></option>
                            <option value="true" ng-selected="template.rights.other.write === true">O</option>
                            <option value="false" ng-selected="template.rights.other.write === false">N</option>
                        </select>

                            X <select ng-model="template.rights.other.execute">
                            <option value="" ng-selected="template.rights.other.execute == null"></option>
                            <option value="true" ng-selected="template.rights.other.execute === true">O</option>
                            <option value="false" ng-selected="template.rights.other.execute === false">N</option>
                        </select>
                        </fieldset>
                    </div>
                </form>
            </md-content>
        </div>

        <md-dialog-actions>
            <md-button ng-click="$save(template)" class="md-raised md-primary" ng-disabled="templateForm.$invalid" ng-hide="isReadOnly">Sauver le template</md-button>
            <md-button ng-click="$close(template)" class="md-raised md-success" ng-disabled="templateForm.$invalid" ng-hide="isReadOnly">Sauver et fermer</md-button>
            <md-button ng-click="$closeDialog('cancel')" class="md-raised md-warn">Annuler</md-button>
        </md-dialog-actions>
    </md-dialog-content>
</md-dialog>