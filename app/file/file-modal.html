<md-dialog flex="60">
    <md-dialog-content>
        <div class="ng-binding">
            <h2>{{ 'file.modal.title' | translate }} {{instance.name}}</h2>
            <md-content layout-padding class="autoScroll max-width-none">
                <form novalidate ng-repeat="(index, item) in fileEntries track by $index" heading="{{item.name}}">
                    <section class="file-header">
                        <div layout="row" flex="100">
                            <div flex="5">
                                <a class="md-button md-xs btn-download-alert-file" href="{{item.url}}" ng-if ="item.on_error == false" download="{{item.name}}">
                                    <md-icon class="fa fa-download"></md-icon>
                                </a>
                                <a class="md-button md-xs btn-download-alert-file" href="" ng-if="item.on_error == true" ng-click="open(index)">
                                    <md-icon class="fa fa-exclamation-triangle"></md-icon>
                                </a>
                            </div>
                            <div flex="95">
                                <md-button ng-click="open(index)" class="file-title">{{item.name}} ( {{item.rights}} )</md-button>
                            </div>
                            <!-- Error tooltip text -->
                            <md-tooltip ng-if="item.on_error == true">{{ 'file.modal.error' | translate }}</md-tooltip>
                        </div>

                        <!-- Add css class 'ng-hide' to disable display at startup and for working autorefresh plugin -->
                        <div ng-show="index === isOpen" class="file-content ng-hide" layout="column" flex="100">

                            <div flex="5">
                                <label class="template-section-header">{{ 'file.modal.content' | translate }}</label>
                                <!--<kbd>F11</kbd> Activer /
                                <kbd>Esc</kbd> Désactiver l'édition en plein écran
                                -->
                            </div>

                            <div id="templateContentParent" flex="95">
                                <div ng-switch = "item.on_error">
                                    <div ng-switch-when="true" class="file-error">
                                        <strong>Erreur !</i></strong> {{item.content}}
                                    </div>
                                    <ui-codemirror id="templateContent" ui-codemirror-opts="codeMirrorOptions"
                                                   ng-model="item.content" ng-keydown="$checkIfCodeMirrorInFullScreen($event)"
                                                   ng-switch-default
                                            ></ui-codemirror>
                                </div>
                            </div>
                        </div>
                    </section>
                </form>
            </md-content>
        </div>
        <md-dialog-actions>
            <md-button ng-click="download_all_instance_files()" class="md-raised md-primary" ng-disabled="moduleForm.$invalid">{{ 'button.modal.download' | translate }}</md-button>
            <md-button ng-click="$closeDialog()" class="md-raised md-warn">{{ 'button.modal.cancel' | translate }}</md-button>
        </md-dialog-actions>
    </md-dialog-content>
</md-dialog>